---
environment:
  title: _compressibleFlowCadExample
  tagDirectory: true
arguments: {}
timestepper:
  arguments:
    ts_type: rk
    ts_max_time: 100000
    ts_max_steps: 5
    ts_dt: 1.0E-10
    ts_adapt_safety: 0.9
  domain: !<!ablate::domain::MeshFile>
    name: exampleNozzle
    path: ../geom/rectangle_inverted_testing_fix.msh
    options:
      dm_refine: 0
      dm_plex_check_all: true
    modifiers:
      - !<!ablate::domain::modifiers::TagMeshBoundaryFaces>
        region:
          name: marker
      - !<!ablate::domain::modifiers::ExtrudeLabel>
        regions:
          - name: marker
        boundaryRegion:
          name: boundaryFaces
        originalRegion:
          name: flowRegion
        extrudedRegion:
          name: boundaryCells
        thickness: 0.001
      - !<!ablate::domain::modifiers::DistributeWithGhostCells>
        ghostCellDepth: 2
      - !<!ablate::domain::modifiers::CreateLabel>
        region:
          name: inletBoundaryCells
        function: "z < 0 ? 1.0 : 0"
      - !<!ablate::domain::modifiers::CreateLabel>
        region:
          name: outletBoundaryCells
        function: "z > 0.5 ? 1.0 : 0"
      - !<!ablate::domain::modifiers::SubtractLabel>
        differenceRegion:
          name: wallBoundaryCells
        minuendRegion:
          name: boundaryCells
        subtrahendRegions:
          - name: outletBoundaryCells
          - name: inletBoundaryCells
    fields:
      - !<!ablate::finiteVolume::CompressibleFlowFields>
        eos: !<!ablate::eos::PerfectGas> &1
          parameters:
            gamma: 1.4
            Rgas: 287.0
  initialization:
    - !<!ablate::finiteVolume::fieldFunctions::Euler>
      state: &2
        eos: *1
        pressure: 101325.0
        temperature: !<!ablate::mathFunctions::geom::Cylinder>
          start: [0.0, 0.0, 0]
          end: [0.0, 0.0, .01]
          radius: 0.005
          insideValues: [1500]
          outsideValues: [298.15]
        velocity: !<!ablate::mathFunctions::geom::Cylinder>
          start: [0.0, 0.0, 0]
          end: [0.0, 0.0, .1]
          radius: 0.01
          insideValues: 0.0, 0.0, 100000.0
          outsideValues: 0.0, 0.0, 0.0
    - !<!ablate::finiteVolume::fieldFunctions::Euler>
      region:
        name: boundaryCells
      state: *2
solvers:
  - !<!ablate::finiteVolume::CompressibleFlowSolver>
    id: vortexFlowField
    region:
      name: flowRegion
    additionalProcesses:
      - !<!ablate::finiteVolume::processes::PressureGradientScaling> &3
        eos: *1
        alphaInit: 10.0
        maxAlphaAllowed: 100.0
        domainLength: 0.2
        log: !<!ablate::monitors::logs::StdOut> ""
    computePhysicsTimeStep: false
    fluxCalculator: !<!ablate::finiteVolume::fluxCalculator::AusmpUp>
      pgs: *3
    parameters:
      cfl: 0.25
    eos: *1
    transport: !<!ablate::eos::transport::Sutherland>
      eos: *1
    monitors:
      - !<!ablate::monitors::TimeStepMonitor>
        interval: 5
      - !<!ablate::monitors::MaxMinAverage>
        field: velocity
        interval: 5
  - !<!ablate::boundarySolver::BoundarySolver>
    id: wallBoundary
    region:
      name: wallBoundaryCells
    fieldBoundary:
      name: boundaryFaces
    mergeFaces: true
    processes:
      - !<!ablate::boundarySolver::lodi::IsothermalWall>
        eos: *1
        pgs: *3
  - !<!ablate::boundarySolver::BoundarySolver>
    id: inlet
    region:
      name: inletBoundaryCells
    fieldBoundary:
      name: boundaryFaces
    mergeFaces: true
    processes:
      - !<!ablate::boundarySolver::lodi::Inlet>
        eos: *1
        pgs: *3
  - !<!ablate::boundarySolver::BoundarySolver>
    id: outlet
    region:
      name: outletBoundaryCells
    fieldBoundary:
      name: boundaryFaces
    mergeFaces: true
    processes:
      - !<!ablate::boundarySolver::lodi::OpenBoundary>
        eos: *1
        reflectFactor: 0.0
        referencePressure: 101325.0
        maxAcousticsLength: 0.1
        pgs: *3
