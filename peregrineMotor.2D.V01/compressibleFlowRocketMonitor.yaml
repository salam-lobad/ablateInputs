# ### Description
# A test of the rocket monitor output (thrust, specific impulse) using a simple 2d 5x20 plane of cells
---

environment:
  title: _compressibleFlowRocketMonitor
  tagDirectory: true
arguments: { }
timestepper:
  io:
    interval: 0
  arguments:
    ts_type: rk
    ts_max_time: 100000
    ts_max_steps: 5
    ts_dt: 1.0E-10
    ts_adapt_safety: 0.9
  domain: !ablate::domain::BoxMeshBoundaryCells
    name: simpleBoxField
    faces: [ 5, 20 ]
    lower: [ 0 , -0.5 ]
    upper: [ 0.5 , 0.5 ]
    simplex: false
    options:
      dm_refine: 0
      dm_plex_hash_location: true
    preModifiers:
      - !ablate::domain::modifiers::DistributeWithGhostCells
    postModifiers:

      - !ablate::domain::modifiers::TagLabelInterface
        leftRegion:
          name: interiorCells
        rightRegion:
          name: boundaryCellsRight
        boundaryFaceRegion:
          name: outletBoundaryFaces
        leftBoundaryCellRegion:
          name: outletFlowCells
      - !ablate::domain::modifiers::GhostBoundaryCells
      - !ablate::monitors::DmViewFromOptions
        options: ascii
      - !ablate::monitors::DmViewFromOptions
        options: ascii::ascii_info_detail
      - !ablate::monitors::DmViewFromOptions
        options: ":$OutputDirectory/mesh.tex:ascii_latex"
    fields:
      - !ablate::finiteVolume::CompressibleFlowFields
        eos: !ablate::eos::PerfectGas &eos
          parameters:
            gamma: 1.4
            Rgas: 287.0
      - !ablate::domain::FieldDescription
        name: pressure
        type: FV
        location: aux
  initialization:
    - !ablate::finiteVolume::fieldFunctions::Euler
      state: &initFlowState
        eos: *eos
        pressure: 101325.0
#        pressure: "101325.0 + 15000*y"
        temperature: 300
        velocity: "100, 0"
#        velocity: "50 + 25*y, 10*y"
#        velocity: " 0 , 10*y "
solvers:
  - !ablate::finiteVolume::CompressibleFlowSolver
    id: flowField
    region:
      name: interiorCells
    eos: *eos
    monitors:
      - !ablate::monitors::RocketMonitor
        eos: *eos
        region:
          name: outletFlowCells
        fieldBoundary:
          name: outletBoundaryFaces
        interval: 0