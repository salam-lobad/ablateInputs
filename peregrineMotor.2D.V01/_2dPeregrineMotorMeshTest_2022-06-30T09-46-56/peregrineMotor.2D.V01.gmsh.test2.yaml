---
environment:
  title: _2dPeregrineMotorMeshTest
  tagDirectory: true
arguments: {}
timestepper:
  arguments:
    ts_type: rk
    ts_max_time: 100000
    ts_max_steps: 100
    ts_dt: 1.0E-5
    ts_adapt_safety: 0.9
  domain: !<!ablate::domain::MeshFile>
    name: exampleNozzle
    path: ../geom/cylinder2d_refined.msh
    options:
      dm_refine: 0
      dm_plex_check_all: true
    modifiers:
      - !<!ablate::domain::modifiers::TagMeshBoundaryFaces>
        region:
          name: marker
      - !<!ablate::domain::modifiers::ExtrudeLabel>
        regions:
          - name: marker
        boundaryRegion:
          name: boundaryFaces
        originalRegion:
          name: flowRegion
        extrudedRegion:
          name: boundaryCells
        thickness: 0.001
      - !<!ablate::domain::modifiers::DistributeWithGhostCells>
        ghostCellDepth: 2
      - !<!ablate::domain::modifiers::CreateLabel>
        region:
          name: inletBoundaryCells
        function: "x < 0 ? 1.0 : 0"
      - !<!ablate::domain::modifiers::CreateLabel>
        region:
          name: outletBoundaryCells
        function: "x > 2.105 ? 1.0 : 0"
      - !<!ablate::domain::modifiers::SubtractLabel>
        differenceRegion:
          name: wallBoundaryCells
        minuendRegion:
          name: boundaryCells
        subtrahendRegions:
          - name: outletBoundaryCells
          - name: inletBoundaryCells
      - !<!ablate::domain::modifiers::TagLabelInterface>
        leftRegion:
          name: flowRegion
        rightRegion:
          name: wallBoundaryCells
        boundaryFaceRegion:
          name: chamberWallBoundaryFaces
        rightBoundaryCellRegion:
          name: chamberWallBoundaryCells
      - !<!ablate::domain::modifiers::SubtractLabel>
        differenceRegion:
          name: interiorFlowRegion
        minuendRegion:
          name: flowRegion
        subtrahendRegions:
          - name: chamberWallBoundaryFaces
        incompleteLabel: true
      - !<!ablate::monitors::DmViewFromOptions>
        options: ascii
      - !<!ablate::monitors::DmViewFromOptions>
        options: ascii::ascii_info_detail
      - !<!ablate::monitors::DmViewFromOptions>
        options: :$OutputDirectory/mesh.tex:ascii_latex
    fields:
      - !<!ablate::finiteVolume::CompressibleFlowFields>
        eos: !<!ablate::eos::TChem> &1
          mechFile: ../mechanisms/grimech30.mech.dat
          thermoFile: ../mechanisms/grimech30.thermo.dat
        conservedFieldOptions:
          petscfv_type: upwind
      - !<!ablate::domain::FieldDescription>
        name: pressure
        type: FV
        location: aux
        region:
          name: domain
  initialization:
    - !<!ablate::finiteVolume::fieldFunctions::Euler>
      state: &2
        eos: *1
        pressure: 101325.0
        temperature: 300
        velocity: !<!ablate::mathFunctions::geom::Cylinder>
          start: [0, 0.1]
          end: [.1, 0.1]
          radius: 0.05
          insideValues: 100.0, 0.0
          outsideValues: 0.0, 0.0
        massFractions: !<!ablate::finiteVolume::fieldFunctions::MassFractions>
          eos: *1
          values:
            - fieldName: O2
              field: 0.22968530497578818
            - fieldName: N2
              field: 0.7703146950242119
    - !<!ablate::finiteVolume::fieldFunctions::Euler>
      region:
        name: chamberWallBoundaryCells
      state: *2
solvers:
  - !<!ablate::finiteVolume::CompressibleFlowSolver>
    id: vortexFlowField
    region:
      name: flowRegion
    additionalProcesses:
      - !<!ablate::finiteVolume::processes::PressureGradientScaling> &3
        eos: *1
        alphaInit: 10.0
        maxAlphaAllowed: 100.0
        domainLength: 0.2
        log: !<!ablate::monitors::logs::StdOut> ""
    computePhysicsTimeStep: false
    fluxCalculator: !<!ablate::finiteVolume::fluxCalculator::AusmpUp>
      pgs: *3
    parameters:
      cfl: 0.25
    eos: *1
    transport: !<!ablate::eos::transport::Sutherland>
      eos: *1
    monitors:
      - !<!ablate::monitors::MaxMinAverage>
        field: velocity
  - !<!ablate::boundarySolver::BoundarySolver>
    id: wallBoundary
    region:
      name: wallBoundaryCells
    fieldBoundary:
      name: boundaryFaces
    mergeFaces: true
    processes:
      - !<!ablate::boundarySolver::lodi::IsothermalWall>
        eos: *1
        pgs: *3
  - !<!ablate::boundarySolver::BoundarySolver>
    id: inlet
    region:
      name: inletBoundaryCells
    fieldBoundary:
      name: boundaryFaces
    mergeFaces: true
    processes:
      - !<!ablate::boundarySolver::lodi::Inlet>
        eos: *1
        pgs: *3
  - !<!ablate::boundarySolver::BoundarySolver>
    id: outlet
    region:
      name: outletBoundaryCells
    fieldBoundary:
      name: boundaryFaces
    mergeFaces: true
    processes:
      - !<!ablate::boundarySolver::lodi::OpenBoundary>
        eos: *1
        reflectFactor: 0.0
        referencePressure: 101325.0
        maxAcousticsLength: 0.1
        pgs: *3
